<div class="container-fluid mt-4" style="background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); min-height: 100vh;">
  
  <!-- Index/Sector View Toggle -->
  <div class="row mb-3">
    <div class="col-12 d-flex justify-content-center">
      <div class="toggle-switch-container">
        <button 
          type="button" 
          class="toggle-btn" 
          [class.active]="currentView === 'banknifty'"
          (click)="currentView = 'banknifty'">
          <i class="fas fa-chart-line"></i> Index View
        </button>
        <button 
          type="button" 
          class="toggle-btn" 
          [class.active]="currentView === 'sectors'"
          (click)="currentView = 'sectors'">
          <i class="fas fa-layer-group"></i> Sector View
        </button>
        <div class="toggle-slider" [class.sector-active]="currentView === 'sectors'"></div>
      </div>
    </div>
  </div>

  <!-- Header Section with Market Status -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none;">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h2 class="mb-2">
                <i [class]="currentView === 'banknifty' ? 'fas fa-chart-line' : 'fas fa-layer-group'"></i> 
                {{ currentView === 'banknifty' ? 'Market Dashboard - Index Analysis' : 'Market Dashboard - Sector Analysis' }}
              </h2>
              <p class="mb-0" style="opacity: 0.9;">
                {{ currentView === 'banknifty' ? 'Live tracking of Bank Nifty & top market indices' : 'Real-time sector performance & rotation tracking' }}
              </p>
            </div>
            <div class="text-right" *ngIf="currentView === 'banknifty'">
              <div class="badge badge-pill px-3 py-2" 
                   [ngClass]="hdfcTrend >= 1 && banksTrend >= 2 ? 'badge-success' : (hdfcTrend == 0 && banksTrend <= 1 ? 'badge-danger' : 'badge-warning')"
                   style="font-size: 1rem;">
                <i class="fas" [ngClass]="hdfcTrend >= 1 && banksTrend >= 2 ? 'fa-arrow-trend-up' : (hdfcTrend == 0 && banksTrend <= 1 ? 'fa-arrow-trend-down' : 'fa-minus')"></i>
                {{ hdfcTrend >= 1 && banksTrend >= 2 ? 'Bullish' : (hdfcTrend == 0 && banksTrend <= 1 ? 'Bearish' : 'Mixed') }}
              </div>
              <div class="mt-2" style="font-size: 0.85rem; opacity: 0.85;">
                <i class="fas fa-sync-alt"></i> Auto-refresh every 30s
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- BANK NIFTY VIEW -->
  <div *ngIf="currentView === 'banknifty'">
  
  <!-- Trend Indicators Cards - Simplified -->
  <div class="row mb-4">
    <!-- Single Combined Trend Card -->
    <div class="col-lg-3 col-md-6 mb-3">
      <div class="card h-100" [ngStyle]="{'border-left': '5px solid ' + (hdfcTrend >= 1 && banksTrend >= 2 ? '#10b981' : (hdfcTrend == 0 && banksTrend <= 1 ? '#ef4444' : '#f59e0b'))}">
        <div class="card-body text-center">
          <h6 class="text-muted mb-2"><i class="fas fa-chart-pie"></i> Market Trend</h6>
          <h1 class="mb-2" [ngClass]="hdfcTrend >= 1 && banksTrend >= 2 ? 'text-success' : (hdfcTrend == 0 && banksTrend <= 1 ? 'text-danger' : 'text-warning')" style="font-size: 2.5rem; font-weight: 800;">
            {{ hdfcTrend >= 1 && banksTrend >= 2 ? 'BULLISH' : (hdfcTrend == 0 && banksTrend <= 1 ? 'BEARISH' : 'MIXED') }}
          </h1>
          <div class="mb-2">
            <span class="badge" [ngClass]="hdfcTrend >= 1 && banksTrend >= 2 ? 'badge-success' : (hdfcTrend == 0 && banksTrend <= 1 ? 'badge-danger' : 'badge-warning')">
              Top 5: {{hdfcTrend + banksTrend}}/5 Above VWAP
            </span>
          </div>
          <small class="text-muted">HDFC: {{hdfcTrend}}/1 | Others: {{banksTrend}}/4</small>
        </div>
      </div>
    </div>
    
    <!-- Market Breadth -->
    <div class="col-lg-3 col-md-6 mb-3">
      <div class="card h-100" style="border-left: 5px solid #6366f1;">
        <div class="card-body text-center">
          <h6 class="text-muted mb-2"><i class="fas fa-balance-scale"></i> Market Breadth</h6>
          <h1 class="mb-2 text-primary" style="font-size: 2.5rem; font-weight: 800;">
            {{ (allbankTrands / 14 * 100).toFixed(0) }}%
          </h1>
          <div class="progress mb-2" style="height: 8px;">
            <div class="progress-bar" [ngClass]="allbankTrands >= 10 ? 'bg-success' : (allbankTrands >= 7 ? 'bg-warning' : 'bg-danger')"
                 role="progressbar" [style.width.%]="(allbankTrands / 14 * 100)"></div>
          </div>
          <small class="text-muted">{{allbankTrands}} of 14 Banks Above VWAP</small>
        </div>
      </div>
    </div>
    
    <!-- Nifty 50 Strength -->
    <div class="col-lg-3 col-md-6 mb-3">
      <div class="card h-100" style="border-left: 5px solid #f59e0b;">
        <div class="card-body text-center">
          <h6 class="text-muted mb-2"><i class="fas fa-trophy"></i> Nifty Top 10</h6>
          <h1 class="mb-2" [ngClass]="niftyaboveVwap >= 7 ? 'text-success' : (niftyaboveVwap >= 5 ? 'text-warning' : 'text-danger')" style="font-size: 2.5rem; font-weight: 800;">
            {{niftyaboveVwap}}/10
          </h1>
          <div class="progress mb-2" style="height: 8px;">
            <div class="progress-bar" [ngClass]="niftyaboveVwap >= 7 ? 'bg-success' : (niftyaboveVwap >= 5 ? 'bg-warning' : 'bg-danger')"
                 role="progressbar" [style.width.%]="(niftyaboveVwap / 10 * 100)"></div>
          </div>
          <small class="text-muted">Stocks Above VWAP ({{(niftyaboveVwap / 10 * 100).toFixed(0)}}%)</small>
        </div>
      </div>
    </div>
    
    <!-- Quick Stats -->
    <div class="col-lg-3 col-md-6 mb-3">
      <div class="card h-100" style="border-left: 5px solid #8b5cf6;">
        <div class="card-body text-center">
          <h6 class="text-muted mb-2"><i class="fas fa-info-circle"></i> Quick Stats</h6>
          <div class="mb-3">
            <small class="text-muted d-block mb-1">Indices Positive</small>
            <h3 class="mb-0" [ngClass]="positiveIndicesCount > 0 ? 'text-success' : 'text-muted'" style="font-weight: 700;">
              {{ positiveIndicesCount }}/{{ totalIndicesCount }}
            </h3>
          </div>
          <div>
            <small class="text-muted d-block mb-1">Overall Sentiment</small>
            <span class="badge badge-pill px-3 py-2" 
                  [ngStyle]="{
                    'background-color': overallSentiment === 'Strong' ? '#10b981' : (overallSentiment === 'Weak' ? '#ef4444' : '#f59e0b'),
                    'color': 'white'
                  }"
                  style="font-size: 0.9rem; font-weight: 600;">
              {{ overallSentiment }}
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Data - All in One Row -->
  <div class="row mb-4">
    <!-- Bank Nifty Constituents -->
    <div class="col-lg-4 col-md-6 mb-3 mb-lg-0">
      <div class="card h-100">
        <div class="card-header text-white" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
          <div class="d-flex justify-content-between align-items-center">
            <h6 class="mb-0"><i class="fas fa-table"></i> Bank Nifty</h6>
            <span class="badge badge-light" style="font-size: 0.75rem;">{{allbankTrands}}/14 VWAP</span>
          </div>
        </div>
        <div class="card-body p-0">
          <ag-grid-angular 
            class="ag-theme-quartz" 
            style="height:450px;width: 100%" 
            [rowData]="rowData"
            [rowSelection]="rowSelection" 
            [pagination]="false" 
            [defaultColDef]="defaultColDef"
            [domLayout]="'normal'" 
            [columnDefs]="colDefs">
          </ag-grid-angular>
        </div>
      </div>
    </div>
    
    <!-- Nifty Top 10 Stocks -->
    <div class="col-lg-4 col-md-6 mb-3 mb-lg-0">
      <div class="card h-100">
        <div class="card-header text-white" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">
          <div class="d-flex justify-content-between align-items-center">
            <h6 class="mb-0"><i class="fas fa-trophy"></i> Nifty Top 10</h6>
            <span class="badge badge-light" style="font-size: 0.75rem;">{{niftyaboveVwap}}/10 VWAP</span>
          </div>
        </div>
        <div class="card-body p-0">
          <ag-grid-angular 
            class="ag-theme-quartz" 
            style="height:450px;width: 100%"
            [rowData]="rowTopData"
            [rowSelection]="rowSelection" 
            [pagination]="false" 
            [defaultColDef]="defaultColDef"
            [domLayout]="'normal'" 
            [columnDefs]="colDefs">
          </ag-grid-angular>
        </div>
      </div>
    </div>

    <!-- Indices Summary & Bank Strength -->
    <div class="col-lg-4 col-md-12">
      <div class="row h-100">
        <!-- Indices Summary -->
        <div class="col-12 mb-3">
          <div class="card">
            <div class="card-header bg-info text-white">
              <h6 class="mb-0"><i class="fas fa-list"></i> Indices Summary</h6>
            </div>
            <div class="card-body p-0">
              <table class="table table-hover table-sm mb-0">
                <thead style="background: #f8f9fa;">
                  <tr>
                    <th style="font-size: 0.8rem;">Index</th>
                    <th style="font-size: 0.8rem;">Price</th>
                    <th style="font-size: 0.8rem;">Change%</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let item of indexValues">
                    <td style="font-weight: 600; font-size: 0.85rem;">{{item.name}}</td>
                    <td style="font-size: 0.85rem;">{{item.close | number : '1.2-2'}}</td>
                    <td style="font-size: 0.85rem;" [ngClass]="item.preChange > 0 ? 'text-success' : 'text-danger'">
                      <strong>{{item.preChange | number : '1.2-2'}}%</strong>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Top 5 Banks Strength Card -->
        <div class="col-12">
          <div class="card">
            <div class="card-body text-center d-flex flex-column justify-content-center" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border-radius: 0.25rem; min-height: 200px;">
              <h6 class="mb-3"><i class="fas fa-medal"></i> Top 5 Banks Strength</h6>
              <h1 class="mb-2" style="font-weight: 800; font-size: 3rem;">{{ banksTrend + hdfcTrend }} / 5</h1>
              <p class="mb-0" style="opacity: 0.9; font-size: 0.95rem;">Banks trading above VWAP</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  </div>
  <!-- END BANK NIFTY VIEW -->

  <!-- SECTORS VIEW -->
  <div *ngIf="currentView === 'sectors'">
    <app-sector-tracker></app-sector-tracker>
  </div>
  <!-- END SECTORS VIEW -->

  <!-- OI & IV Quick Reference Guide -->
  <style>
    .table .badge {
      color: #fff !important;
    }
    .table .badge-secondary {
      background-color: #6c757d !important;
      color: #fff !important;
    }
    .table .badge-success {
      background-color: #28a745 !important;
      color: #fff !important;
    }
    .table .badge-danger {
      background-color: #dc3545 !important;
      color: #fff !important;
    }
    .table .badge-warning {
      background-color: #ffc107 !important;
      color: #000 !important;
    }
    .table .badge-info {
      background-color: #17a2b8 !important;
      color: #fff !important;
    }
  </style>
  <div class="row mt-4 mb-4">
    <div class="col-12">
      <div class="card shadow-lg" style="border: none; border-radius: 15px; overflow: hidden;">
        <div class="card-header text-white text-center py-3" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
          <h4 class="mb-0"><i class="fas fa-book-open"></i> OI & IV Quick Reference Guide</h4>
          <p class="mb-0 mt-2" style="font-size: 0.9rem; opacity: 0.9;">Master Option Trading Signals - Key Indicators Explained</p>
        </div>
        <div class="card-body p-0">
          
          <!-- OI (Open Interest) Table -->
          <div class="table-responsive">
            <table class="table table-hover mb-0" style="font-size: 0.9rem;">
              <thead style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white;">
                <tr>
                  <th colspan="6" class="text-center py-3" style="font-size: 1.1rem;">
                    <i class="fas fa-chart-bar"></i> OI (Open Interest) - "Smart Money Tracking"
                  </th>
                </tr>
                <tr style="background: #1e40af; color: white;">
                  <th style="width: 15%;">Scenario</th>
                  <th style="width: 20%;">Call OI</th>
                  <th style="width: 20%;">Put OI</th>
                  <th style="width: 15%;">Signal</th>
                  <th style="width: 15%;">Action</th>
                  <th style="width: 15%;">Example</th>
                </tr>
              </thead>
              <tbody>
                <tr style="background: #dfffd6; color: #000;">
                  <td><strong style="color: #000;">üî¥ High Call OI</strong></td>
                  <td><span class="badge badge-danger">Very High (>1L)</span></td>
                  <td><span class="badge badge-secondary">Low</span></td>
                  <td><strong style="color: #dc2626;">RESISTANCE</strong></td>
                  <td><span class="badge badge-warning">‚ö†Ô∏è Don't Buy Above</span></td>
                  <td><small style="color: #000;">Nifty 19500 has 2L Call OI</small></td>
                </tr>
                <tr style="background: #fff4d6; color: #000;">
                  <td><strong style="color: #000;">üü¢ High Put OI</strong></td>
                  <td><span class="badge badge-secondary">Low</span></td>
                  <td><span class="badge badge-success">Very High (>1L)</span></td>
                  <td><strong style="color: #16a34a;">SUPPORT</strong></td>
                  <td><span class="badge badge-success">‚úÖ Buy Zone</span></td>
                  <td><small style="color: #000;">Nifty 19000 has 1.5L Put OI</small></td>
                </tr>
                <tr style="background: #e0f2fe; color: #000;">
                  <td><strong style="color: #000;">‚öñÔ∏è Balanced OI</strong></td>
                  <td><span class="badge badge-info">Medium</span></td>
                  <td><span class="badge badge-info">Medium</span></td>
                  <td><strong style="color: #0284c7;">NEUTRAL</strong></td>
                  <td><span class="badge badge-info">üìä Wait & Watch</span></td>
                  <td><small style="color: #000;">ATM strike - equal interest</small></td>
                </tr>
                <tr style="background: #ffe4e4; color: #000;">
                  <td><strong style="color: #000;">üìà Call OI Increasing</strong></td>
                  <td><span class="badge badge-danger">+50% ‚Üë</span></td>
                  <td><span class="badge badge-secondary">Stable</span></td>
                  <td><strong style="color: #dc2626;">Building Resistance</strong></td>
                  <td><span class="badge badge-warning">‚ö†Ô∏è Caution - Book Profit</span></td>
                  <td><small style="color: #000;">BankNifty 44500 +870%</small></td>
                </tr>
                <tr style="background: #d1fae5; color: #000;">
                  <td><strong style="color: #000;">üìâ Put OI Increasing</strong></td>
                  <td><span class="badge badge-secondary">Stable</span></td>
                  <td><span class="badge badge-success">+40% ‚Üë</span></td>
                  <td><strong style="color: #16a34a;">Building Support</strong></td>
                  <td><span class="badge badge-success">‚úÖ Buying Opportunity</span></td>
                  <td><small style="color: #000;">BankNifty 44000 +560%</small></td>
                </tr>
                <tr style="background: #fef3c7; color: #000;">
                  <td><strong style="color: #000;">üîÑ Both OI Increasing</strong></td>
                  <td><span class="badge badge-danger">+30% ‚Üë</span></td>
                  <td><span class="badge badge-success">+35% ‚Üë</span></td>
                  <td><strong style="color: #ca8a04;">RANGE BOUND</strong></td>
                  <td><span class="badge badge-warning">üìä Trade Range Only</span></td>
                  <td><small style="color: #000;">Market stuck 19000-19500</small></td>
                </tr>
                <tr style="background: #fee2e2; color: #000;">
                  <td><strong style="color: #000;">‚ö° Both OI Decreasing</strong></td>
                  <td><span class="badge badge-danger">-20% ‚Üì</span></td>
                  <td><span class="badge badge-success">-25% ‚Üì</span></td>
                  <td><strong style="color: #991b1b;">UNWINDING</strong></td>
                  <td><span class="badge badge-danger">üö´ Exit Positions</span></td>
                  <td><small style="color: #000;">Trend reversal likely</small></td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- IV (Implied Volatility) Table -->
          <div class="table-responsive mt-0">
            <table class="table table-hover mb-0" style="font-size: 0.9rem;">
              <thead style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); color: white;">
                <tr>
                  <th colspan="6" class="text-center py-3" style="font-size: 1.1rem;">
                    <i class="fas fa-bolt"></i> IV (Implied Volatility) - "Market Panic Meter"
                  </th>
                </tr>
                <tr style="background: #6d28d9; color: white;">
                  <th style="width: 15%;">IV Level</th>
                  <th style="width: 15%;">Range</th>
                  <th style="width: 20%;">Market State</th>
                  <th style="width: 20%;">Premium Cost</th>
                  <th style="width: 15%;">Action</th>
                  <th style="width: 15%;">Example</th>
                </tr>
              </thead>
              <tbody>
                <tr style="background: #d1fae5; color: #000;">
                  <td><strong style="color: #000;">üò¥ Very Low IV</strong></td>
                  <td><span class="badge badge-success">< 12%</span></td>
                  <td><strong style="color: #059669;">Calm Market</strong><br><small style="color: #000;">No panic, low movement</small></td>
                  <td><span class="badge badge-success">üí∞ Very Cheap</span></td>
                  <td><span class="badge badge-success">‚úÖ BUY Options</span></td>
                  <td><small style="color: #000;">VIX at 10-11</small></td>
                </tr>
                <tr style="background: #dfffd6; color: #000;">
                  <td><strong style="color: #000;">üòä Low IV</strong></td>
                  <td><span class="badge badge-success">12-18%</span></td>
                  <td><strong style="color: #16a34a;">Stable Market</strong><br><small style="color: #000;">Normal trading</small></td>
                  <td><span class="badge badge-success">üíµ Cheap</span></td>
                  <td><span class="badge badge-success">‚úÖ Good to Buy</span></td>
                  <td><small style="color: #000;">VIX at 12-15</small></td>
                </tr>
                <tr style="background: #fef3c7; color: #000;">
                  <td><strong style="color: #000;">üòê Medium IV</strong></td>
                  <td><span class="badge badge-warning">18-25%</span></td>
                  <td><strong style="color: #ca8a04;">Normal Volatility</strong><br><small style="color: #000;">Moderate swings</small></td>
                  <td><span class="badge badge-warning">üí≥ Fair Price</span></td>
                  <td><span class="badge badge-info">üìä Neutral - Cautious</span></td>
                  <td><small style="color: #000;">VIX at 16-20</small></td>
                </tr>
                <tr style="background: #fed7aa; color: #000;">
                  <td><strong style="color: #000;">üò∞ High IV</strong></td>
                  <td><span class="badge badge-warning">25-35%</span></td>
                  <td><strong style="color: #ea580c;">Nervous Market</strong><br><small style="color: #000;">Big moves expected</small></td>
                  <td><span class="badge badge-danger">üí∏ Expensive</span></td>
                  <td><span class="badge badge-warning">‚ö†Ô∏è Don't Buy - Wait</span></td>
                  <td><small style="color: #000;">VIX at 21-28</small></td>
                </tr>
                <tr style="background: #fecaca; color: #000;">
                  <td><strong style="color: #000;">üò± Very High IV</strong></td>
                  <td><span class="badge badge-danger">> 35%</span></td>
                  <td><strong style="color: #dc2626;">Panic/Crisis</strong><br><small style="color: #000;">Extreme volatility</small></td>
                  <td><span class="badge badge-danger">üî• Very Expensive</span></td>
                  <td><span class="badge badge-danger">üö´ AVOID Buying</span></td>
                  <td><small style="color: #000;">VIX at 30+ (COVID era)</small></td>
                </tr>
                <tr style="background: #e0e7ff; color: #000;">
                  <td><strong style="color: #000;">üìà IV Increasing</strong></td>
                  <td><span class="badge badge-info">+5-10% ‚Üë</span></td>
                  <td><strong style="color: #4f46e5;">Fear Building</strong><br><small style="color: #000;">Uncertainty rising</small></td>
                  <td><span class="badge badge-warning">üí∏ Getting Expensive</span></td>
                  <td><span class="badge badge-warning">‚ö†Ô∏è Exit Long Options</span></td>
                  <td><small style="color: #000;">Event upcoming</small></td>
                </tr>
                <tr style="background: #ddd6fe; color: #000;">
                  <td><strong style="color: #000;">üìâ IV Decreasing</strong></td>
                  <td><span class="badge badge-info">-5-10% ‚Üì</span></td>
                  <td><strong style="color: #7c3aed;">Fear Cooling</strong><br><small style="color: #000;">Calm returning</small></td>
                  <td><span class="badge badge-success">üí∞ Getting Cheaper</span></td>
                  <td><span class="badge badge-success">‚úÖ Good Time to Enter</span></td>
                  <td><small style="color: #000;">After event/result</small></td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Combined Strategy Table -->
          <div class="table-responsive mt-0">
            <table class="table table-hover mb-0" style="font-size: 0.9rem;">
              <thead style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white;">
                <tr>
                  <th colspan="5" class="text-center py-3" style="font-size: 1.1rem;">
                    <i class="fas fa-lightbulb"></i> Combined OI + IV Strategy - "Pro Trading Signals"
                  </th>
                </tr>
                <tr style="background: #b45309; color: white;">
                  <th style="width: 25%;">Market Condition</th>
                  <th style="width: 20%;">OI Signal</th>
                  <th style="width: 20%;">IV Level</th>
                  <th style="width: 20%;">Best Strategy</th>
                  <th style="width: 15%;">Risk Level</th>
                </tr>
              </thead>
              <tbody>
                <tr style="background: #d1fae5; color: #000;">
                  <td><strong style="color: #000;">üöÄ Perfect Buy Setup</strong></td>
                  <td><span class="badge badge-success">High Put OI (Support)</span></td>
                  <td><span class="badge badge-success">Low IV (<18%)</span></td>
                  <td><strong style="color: #059669;">BUY ATM Calls</strong><br><small style="color: #000;">Target: High Call OI strike</small></td>
                  <td><span class="badge badge-success">‚úÖ Low Risk</span></td>
                </tr>
                <tr style="background: #fef3c7; color: #000;">
                  <td><strong style="color: #000;">‚ö†Ô∏è Risky Buy Zone</strong></td>
                  <td><span class="badge badge-success">High Put OI (Support)</span></td>
                  <td><span class="badge badge-danger">High IV (>25%)</span></td>
                  <td><strong style="color: #ca8a04;">WAIT for IV to Drop</strong><br><small style="color: #000;">Premiums too expensive</small></td>
                  <td><span class="badge badge-warning">‚ö†Ô∏è High Risk</span></td>
                </tr>
                <tr style="background: #fee2e2; color: #000;">
                  <td><strong style="color: #000;">üõë Danger Zone</strong></td>
                  <td><span class="badge badge-danger">High Call OI (Resistance)</span></td>
                  <td><span class="badge badge-danger">High IV (>25%)</span></td>
                  <td><strong style="color: #dc2626;">DON'T BUY - EXIT</strong><br><small style="color: #000;">Resistance + Expensive = Bad</small></td>
                  <td><span class="badge badge-danger">üö´ Very High</span></td>
                </tr>
                <tr style="background: #e0f2fe; color: #000;">
                  <td><strong style="color: #000;">üìä Range Trading</strong></td>
                  <td><span class="badge badge-info">Both OI High</span></td>
                  <td><span class="badge badge-info">Medium IV (18-25%)</span></td>
                  <td><strong style="color: #0284c7;">Sell Options (Iron Condor)</strong><br><small style="color: #000;">Trade the range only</small></td>
                  <td><span class="badge badge-info">üìä Medium</span></td>
                </tr>
                <tr style="background: #fce7f3; color: #000;">
                  <td><strong style="color: #000;">üéØ Breakout Trade</strong></td>
                  <td><span class="badge badge-danger">Call OI Break</span></td>
                  <td><span class="badge badge-success">Low IV (<18%)</span></td>
                  <td><strong style="color: #ec4899;">BUY ATM Calls Aggressively</strong><br><small style="color: #000;">Resistance broken = Big move</small></td>
                  <td><span class="badge badge-warning">‚ö†Ô∏è Medium</span></td>
                </tr>
                <tr style="background: #ddd6fe; color: #000;">
                  <td><strong style="color: #000;">üìâ Short Selling Setup</strong></td>
                  <td><span class="badge badge-success">Put OI Break Down</span></td>
                  <td><span class="badge badge-success">Low IV (<18%)</span></td>
                  <td><strong style="color: #7c3aed;">BUY ATM Puts</strong><br><small style="color: #000;">Support broken = Fall likely</small></td>
                  <td><span class="badge badge-warning">‚ö†Ô∏è Medium</span></td>
                </tr>
                <tr style="background: #fed7aa; color: #000;">
                  <td><strong style="color: #000;">‚è∞ Event Trading</strong></td>
                  <td><span class="badge badge-info">OI Building Up</span></td>
                  <td><span class="badge badge-danger">IV Spiking (>30%)</span></td>
                  <td><strong style="color: #ea580c;">AVOID Trading</strong><br><small style="color: #000;">Wait for event to pass</small></td>
                  <td><span class="badge badge-danger">üö´ Extreme</span></td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Real Market Examples -->
          <div class="table-responsive mt-0">
            <table class="table table-hover mb-0" style="font-size: 0.9rem;">
              <thead style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white;">
                <tr>
                  <th colspan="6" class="text-center py-3" style="font-size: 1.1rem;">
                    <i class="fas fa-chart-line"></i> Real Market Examples - "Learn from Live Data"
                  </th>
                </tr>
                <tr style="background: #047857; color: white;">
                  <th style="width: 15%;">Index/Stock</th>
                  <th style="width: 20%;">Scenario</th>
                  <th style="width: 20%;">OI Data</th>
                  <th style="width: 15%;">IV Data</th>
                  <th style="width: 15%;">Signal</th>
                  <th style="width: 15%;">Action Taken</th>
                </tr>
              </thead>
              <tbody>
                <tr style="color: #000;">
                  <td><strong style="color: #000;">Nifty 50</strong></td>
                  <td style="color: #000;">Strike 19500 has 2.5L Call OI</td>
                  <td><span class="badge badge-danger">Call: 2.5L</span><br><span class="badge badge-secondary">Put: 0.3L</span></td>
                  <td><span class="badge badge-success">IV: 14%</span></td>
                  <td><span class="badge badge-danger">‚ö†Ô∏è Strong Resistance</span></td>
                  <td><small style="color: #000;">Booked profit at 19450</small></td>
                </tr>
                <tr style="color: #000;">
                  <td><strong style="color: #000;">BankNifty</strong></td>
                  <td style="color: #000;">Strike 44000 Put OI +560%</td>
                  <td><span class="badge badge-success">Put: 1.8L (+560%)</span><br><span class="badge badge-secondary">Call: 0.5L</span></td>
                  <td><span class="badge badge-success">IV: 16%</span></td>
                  <td><span class="badge badge-success">‚úÖ Strong Support</span></td>
                  <td><small style="color: #000;">Bought Calls at 44020</small></td>
                </tr>
                <tr style="color: #000;">
                  <td><strong style="color: #000;">Reliance</strong></td>
                  <td style="color: #000;">Strike 2500 balanced OI</td>
                  <td><span class="badge badge-info">Call: 0.8L</span><br><span class="badge badge-info">Put: 0.85L</span></td>
                  <td><span class="badge badge-warning">IV: 22%</span></td>
                  <td><span class="badge badge-info">üìä ATM - Neutral</span></td>
                  <td><small style="color: #000;">Waited for direction</small></td>
                </tr>
                <tr style="color: #000;">
                  <td><strong style="color: #000;">TCS</strong></td>
                  <td style="color: #000;">Pre-result IV spike</td>
                  <td><span class="badge badge-danger">Call: 1.2L</span><br><span class="badge badge-success">Put: 1.3L</span></td>
                  <td><span class="badge badge-danger">IV: 38%</span></td>
                  <td><span class="badge badge-danger">üö´ Avoid - Too Expensive</span></td>
                  <td><small style="color: #000;">Waited post-result</small></td>
                </tr>
                <tr style="color: #000;">
                  <td><strong style="color: #000;">HDFC Bank</strong></td>
                  <td style="color: #000;">Support break at 1500</td>
                  <td><span class="badge badge-warning">Put: 0.6L (was 1.2L)</span><br><span class="badge badge-secondary">Call: 0.4L</span></td>
                  <td><span class="badge badge-success">IV: 15%</span></td>
                  <td><span class="badge badge-warning">‚ö†Ô∏è Support Broken</span></td>
                  <td><small style="color: #000;">Bought Puts at 1498</small></td>
                </tr>
                <tr style="color: #000;">
                  <td><strong style="color: #000;">Nifty IT</strong></td>
                  <td style="color: #000;">IV crush after event</td>
                  <td><span class="badge badge-success">Put: 0.9L</span><br><span class="badge badge-info">Call: 0.7L</span></td>
                  <td><span class="badge badge-success">IV: 12% (was 28%)</span></td>
                  <td><span class="badge badge-success">‚úÖ Perfect Entry</span></td>
                  <td><small style="color: #000;">Bought ATM Calls cheap</small></td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Key Terms Legend -->
          <div style="background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); color: white; padding: 20px;">
            <div class="row">
              <div class="col-md-6">
                <h6><i class="fas fa-key"></i> Key Terms:</h6>
                <ul style="font-size: 0.85rem; line-height: 1.8;">
                  <li><strong>OI (Open Interest):</strong> Number of active contracts</li>
                  <li><strong>Call OI:</strong> Indicates RESISTANCE (ceiling)</li>
                  <li><strong>Put OI:</strong> Indicates SUPPORT (floor)</li>
                  <li><strong>ATM:</strong> At The Money (current price strike)</li>
                  <li><strong>VIX:</strong> India's volatility index (fear gauge)</li>
                </ul>
              </div>
              <div class="col-md-6">
                <h6><i class="fas fa-graduation-cap"></i> Quick Rules:</h6>
                <ul style="font-size: 0.85rem; line-height: 1.8;">
                  <li>‚úÖ <strong>Buy when:</strong> Low IV + High Put OI (Support)</li>
                  <li>‚ö†Ô∏è <strong>Caution when:</strong> High IV + High Call OI (Resistance)</li>
                  <li>üö´ <strong>Avoid when:</strong> High IV + OI Building at strike</li>
                  <li>üìä <strong>Range trade when:</strong> Both OI high + Medium IV</li>
                  <li>üéØ <strong>Breakout when:</strong> OI breaks + Low IV</li>
                </ul>
              </div>
            </div>
            <div class="row mt-3">
              <div class="col-12 text-center">
                <p class="mb-0" style="font-size: 0.8rem; opacity: 0.8;">
                  <i class="fas fa-info-circle"></i> This guide is for educational purposes. Always do your own research and manage risk properly.
                </p>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
  <!-- End OI & IV Guide -->


</div>