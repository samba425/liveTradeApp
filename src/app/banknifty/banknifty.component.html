<div class="container-fluid mt-4" style="background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); min-height: 100vh;">
  
  <!-- Index/Sector View Toggle -->
  <div class="row mb-3">
    <div class="col-12">
      <div class="btn-group btn-group-lg" role="group" style="box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
        <button 
          type="button" 
          class="btn" 
          [class.btn-info]="currentView === 'banknifty'"
          [class.btn-outline-info]="currentView !== 'banknifty'"
          (click)="currentView = 'banknifty'"
          style="font-weight: 600;">
          <i class="fas fa-chart-line"></i> Index View
        </button>
        <button 
          type="button" 
          class="btn" 
          [class.btn-info]="currentView === 'sectors'"
          [class.btn-outline-info]="currentView !== 'sectors'"
          (click)="currentView = 'sectors'"
          style="font-weight: 600;">
          <i class="fas fa-layer-group"></i> Sector View
        </button>
      </div>
    </div>
  </div>

  <!-- Header Section -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none;">
        <div class="card-body">
          <h2 class="mb-2">
            <i [class]="currentView === 'banknifty' ? 'fas fa-chart-line' : 'fas fa-layer-group'"></i> 
            {{ currentView === 'banknifty' ? 'Market Dashboard - Index Analysis' : 'Market Dashboard - Sector Analysis' }}
          </h2>
          <p class="mb-0" style="opacity: 0.9;">
            {{ currentView === 'banknifty' ? 'Live tracking of Bank Nifty & top market indices' : 'Real-time sector performance & rotation tracking' }}
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- BANK NIFTY VIEW -->
  <div *ngIf="currentView === 'banknifty'">
  
  <!-- Trend Indicators Cards -->
  <div class="row mb-4">
    <div class="col-md-3 col-sm-6 mb-3">
      <div class="card" style="border-left: 5px solid #10b981;">
        <div class="card-body text-center">
          <h6 class="text-muted mb-2"><i class="fas fa-chart-line"></i> Full Bullish Trend</h6>
          <h2 class="mb-0" [ngClass]="hdfcTrend && banksTrend >=2 ? 'text-success' : 'text-muted'">
            {{ hdfcTrend && banksTrend >=2 ? '✓' : '—' }}
          </h2>
          <small *ngIf="hdfcTrend && banksTrend >=2" class="text-success">Strong Bullish Signal</small>
          <small *ngIf="!(hdfcTrend && banksTrend >=2)" class="text-muted">Not Active</small>
        </div>
      </div>
    </div>
    
    <div class="col-md-3 col-sm-6 mb-3">
      <div class="card" style="border-left: 5px solid #f59e0b;">
        <div class="card-body text-center">
          <h6 class="text-muted mb-2"><i class="fas fa-arrows-alt-h"></i> Sideways Trend</h6>
          <h2 class="mb-0" [ngClass]="banksTrend >=2 && !hdfcTrend ? 'text-warning' : 'text-muted'">
            {{ banksTrend >=2 && !hdfcTrend ? '⚠' : '—' }}
          </h2>
          <small *ngIf="banksTrend >=2 && !hdfcTrend" class="text-warning">Mixed Signals</small>
          <small *ngIf="!(banksTrend >=2 && !hdfcTrend)" class="text-muted">Not Active</small>
        </div>
      </div>
    </div>
    
    <div class="col-md-3 col-sm-6 mb-3">
      <div class="card" style="border-left: 5px solid #ef4444;">
        <div class="card-body text-center">
          <h6 class="text-muted mb-2"><i class="fas fa-chart-line fa-rotate-180"></i> Bearish Trend</h6>
          <h2 class="mb-0" [ngClass]="banksTrend <=2 && !hdfcTrend ? 'text-danger' : 'text-muted'">
            {{ banksTrend <=2 && !hdfcTrend ? '↓' : '—' }}
          </h2>
          <small *ngIf="banksTrend <=2 && !hdfcTrend" class="text-danger">Bearish with HDFC</small>
          <small *ngIf="!(banksTrend <=2 && !hdfcTrend)" class="text-muted">Not Active</small>
        </div>
      </div>
    </div>
    
    <div class="col-md-3 col-sm-6 mb-3">
      <div class="card" style="border-left: 5px solid #3b82f6;">
        <div class="card-body text-center">
          <h6 class="text-muted mb-2"><i class="fas fa-arrow-up"></i> Above VWAP</h6>
          <h2 class="mb-0 text-primary">{{ allbankTrands }}</h2>
          <small class="text-muted">All Banks Above VWAP</small>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Data Grid -->
  <div class="row mb-4">
    <div class="col-md-9">
      <div class="card">
        <div class="card-header text-white" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
          <h5 class="mb-0"><i class="fas fa-table"></i> Bank Nifty Constituents</h5>
        </div>
        <div class="card-body">
          <ag-grid-angular 
            class="ag-theme-balham" 
            style="height:400px;width: 100%" 
            [rowData]="rowData"
            [rowSelection]="rowSelection" 
            [pagination]="pagination" 
            [defaultColDef]="defaultColDef"
            [paginationPageSize]="paginationPageSize"
            [domLayout]="'normal'" 
            [columnDefs]="colDefs">
          </ag-grid-angular>
        </div>
      </div>
    </div>
    <!-- Indices Summary Table -->
    <div class="col-md-3">
      <div class="card">
        <div class="card-header bg-info text-white">
          <h6 class="mb-0"><i class="fas fa-list"></i> Indices Summary</h6>
        </div>
        <div class="card-body p-0">
          <table class="table table-hover mb-0">
            <thead style="background: #f8f9fa;">
              <tr>
                <th style="font-size: 0.85rem;">Index</th>
                <th style="font-size: 0.85rem;">Price</th>
                <th style="font-size: 0.85rem;">Change%</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of indexValues">
                <td style="font-weight: 600; font-size: 0.9rem;">{{item.name}}</td>
                <td style="font-size: 0.9rem;">{{item.close | number : '1.2-2'}}</td>
                <td style="font-size: 0.9rem;" [ngClass]="item.preChange > 0 ? 'text-success' : 'text-danger'">
                  <strong>{{item.preChange | number : '1.2-2'}}%</strong>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Top 5 Banks Strength Card -->
      <div class="card mt-3">
        <div class="card-body text-center" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border-radius: 0.25rem;">
          <h6 class="mb-2"><i class="fas fa-medal"></i> Top 5 Banks Strength</h6>
          <h2 class="mb-0" style="font-weight: 800;">{{ banksTrend + hdfcTrend }} / 5</h2>
          <small style="opacity: 0.9;">Banks trading above VWAP</small>
        </div>
      </div>
    </div>
  </div>

  <!-- Nifty Top 10 Section -->
  <div class="row mt-4">
    <div class="col-12">
      <div class="card">
        <div class="card-header text-white" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">
          <div class="d-flex justify-content-between align-items-center">
            <h5 class="mb-0"><i class="fas fa-trophy"></i> Nifty Top 10 Stocks</h5>
            <span class="badge badge-light">{{niftyaboveVwap}} / 10 Above VWAP</span>
          </div>
        </div>
        <div class="card-body">
          <ag-grid-angular 
            class="ag-theme-balham" 
            style="height:400px;width: 100%"
            [rowData]="rowTopData"
            [rowSelection]="rowSelection" 
            [pagination]="pagination" 
            [defaultColDef]="defaultColDef"
            [paginationPageSize]="paginationPageSize"
            [domLayout]="'normal'" 
            [columnDefs]="colDefs">
          </ag-grid-angular>
        </div>
      </div>
    </div>
  </div>
  
  </div>
  <!-- END BANK NIFTY VIEW -->

  <!-- SECTORS VIEW -->
  <div *ngIf="currentView === 'sectors'">
    <app-sector-tracker></app-sector-tracker>
  </div>
  <!-- END SECTORS VIEW -->
  
</div>