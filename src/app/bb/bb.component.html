<div class="container-fluid mt-4" style="background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); min-height: 100vh; padding: 2rem;">
  
  <!-- Header Card -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none;">
        <div class="card-body">
          <h2 class="mb-2"><i class="fas fa-chart-area"></i> Bollinger Bands (BB) Analysis</h2>
          <p class="mb-0" style="opacity: 0.9;">Track price action near Bollinger Bands</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Refresh Button -->
  <div class="row mb-3">
    <div class="col-12">
      <button class="btn btn-primary btn-lg" (click)="refreshData()" [disabled]="isLoading"
              style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; padding: 12px 30px; font-weight: 600;">
        <i class="fas fa-sync-alt" [class.fa-spin]="isLoading"></i> 
        {{ isLoading ? 'Loading...' : 'Refresh Data' }}
      </button>
      <span *ngIf="isLoading" class="ml-3 text-muted">
        <i class="fas fa-spinner fa-spin"></i> Fetching latest data...
      </span>
    </div>
  </div>

  <!-- Loading Overlay -->
  <div *ngIf="isLoading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
      <span class="sr-only">Loading...</span>
    </div>
    <p class="mt-3 text-muted">Loading Bollinger Bands data...</p>
  </div>

<div *ngIf='rowData && rowData.length && !isLoading;else spinner'>
  <div class="row m-2">
    <div class="col-sm-5">
      <ul class="list-group m-1">
        <li class="list-group-item list-group-item-success">
          <h3>BB</h3>
        </li>
      </ul>
    </div>
    <div class="col-sm-5">
      <input class="form-control form-control-lg mt-1" type="text" [(ngModel)]="searchQuery"
        (input)="onSearchInputChange()" placeholder="Search...">
    </div>

    <div class="col-sm-2">
      <button class="btn btn-warning" (click)="onBtnExport()">Download CSV</button>
    </div>
  </div>

  <div class="example-wrapper">
    <ag-grid-angular 
      class="ag-theme-quartz" 
      style="height:600px;width: 100%" 
      [rowData]="rowData"
      [suppressExcelExport]="true" 
      [rowSelection]="rowSelection" 
      [gridOptions]="gridOptions" 
      [pagination]="pagination"
      [defaultColDef]="defaultColDef" 
      [paginationPageSize]="paginationPageSize"
      [domLayout]="'normal'" 
      [columnDefs]="colDefs"
      (gridReady)="onGridReady($event)">
    </ag-grid-angular>
  </div>
  
  <hr>
  <div class="row m-2">
    <div class="col-sm-5">
      <ul class="list-group m-1">
        <li class="list-group-item list-group-item-success">
          <h3>BB Filter List</h3>
        </li>
      </ul>
    </div>
    <div class="col-sm-5">
      <input class="form-control form-control-lg mt-1" type="text" [(ngModel)]="searchQuery1"
        (input)="onSearchInputChangeFiltered()" placeholder="Search...">
    </div>

    <div class="col-sm-2" role="group" >
      <button class="btn m-1  btn-warning" (click)="onBtnExportFiltered()">Download CSV</button>
      <button class="btn  m-1 btn-success" (click)="onlyDojiHammer()">filter</button> 
    </div>
  </div>
  <div class="example-wrapper">
    <ag-grid-angular 
      class="ag-theme-quartz" 
      style="height: 600px;width: 100%" 
      [rowData]="filteredrowData"
      [suppressExcelExport]="true" 
      [rowSelection]="rowSelection" 
      [gridOptions]="gridOptionsfiltered" 
      [pagination]="pagination"
      [defaultColDef]="defaultColDef" 
      [paginationPageSize]="paginationPageSize"
      [domLayout]="'normal'" 
      [columnDefs]="colDefs"
      (gridReady)="onGridReadyFiltered($event)">
    </ag-grid-angular>
  </div>
</div>

<ng-template #spinner>   
  <div class="d-flex justify-content-center">
    <div class="spinner-grow text-success" role="status">
     
    </div>
  </div>
</ng-template>


<div>
  Note: when hammer or doji weekly candle touch lower band .next 15mins candle break high take entry for 1:1.5 ratio
</div>
<!-- <div class="row m-2">
  <div class="col-sm-6">
      <div class="card-body">
        <h4>NOTE:</h4> GOD FATHER diff %
        <h4>If + means Above 200 SMA</h4>
        <h4>If - means Below 200 SMA</h4>
    </div>
  </div>
  <div class="col-sm-6">
      <div class="card-body">
        <h4>NOTE:</h4> Daily after 2.30 % (20SMA %)
        <h4>Highest -% take entry for 3-5% target</h4>
      </div>
  </div>
</div> -->