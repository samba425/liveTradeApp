<div class="container-fluid mt-4" style="background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); min-height: 100vh; padding: 2rem;">
  
  <!-- Header Card -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none;">
        <div class="card-body">
          <h2 class="mb-2"><i class="fas fa-bolt"></i> Momentum & Volume Analysis</h2>
          <p class="mb-0" style="opacity: 0.9;">Discover high-momentum stocks with unusual volume activity</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Refresh Button -->
  <div class="row mb-3">
    <div class="col-12">
      <button class="btn btn-primary btn-lg" (click)="refreshData()" [disabled]="isLoading"
              style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; padding: 12px 30px; font-weight: 600;">
        <i class="fas fa-sync-alt" [class.fa-spin]="isLoading"></i> 
        {{ isLoading ? 'Loading...' : 'Refresh Data' }}
      </button>
      <span *ngIf="isLoading" class="ml-3 text-muted">
        <i class="fas fa-spinner fa-spin"></i> Fetching latest data...
      </span>
    </div>
  </div>

  <!-- Loading Overlay -->
  <div *ngIf="isLoading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
      <span class="sr-only">Loading...</span>
    </div>
    <p class="mt-3 text-muted">Loading volume and momentum data...</p>
  </div>

  <div *ngIf="!isLoading">
  <!-- Momentum Stocks Section -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="card">
        <div class="card-header text-white" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
          <div class="d-flex justify-content-between align-items-center">
            <h5 class="mb-0"><i class="fas fa-rocket"></i> Momentum Stocks</h5>
            <span class="badge badge-light">{{rowStockData.length}} stocks</span>
          </div>
        </div>
        <div class="card-body">
          <!-- Search and Query Controls -->
          <div class="row mb-3">
            <div class="col-md-6">
              <div class="input-group">
                <input 
                  class="form-control" 
                  type="text" 
                  [(ngModel)]="searchStockQuery"
                  (input)="onSearchStockInputChange()" 
                  placeholder="ðŸ” Search stocks..."
                  style="border-radius: 10px 0 0 10px;">
                <div class="input-group-append">
                  <span class="input-group-text" style="background: #667eea; color: white; border-radius: 0 10px 10px 0;">
                    <i class="fas fa-search"></i>
                  </span>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="btn-group w-100" role="group">
                <button type="button" (click)="searchQuerys()" class="btn btn-success">
                  <i class="fas fa-search"></i> M.Search
                </button>
                <button type="button" (click)="near2050SMA()" class="btn btn-info">
                  <i class="fas fa-wave-square"></i> SMA 20/50
                </button>
                <button type="button" (click)="Options()" class="btn btn-primary">
                  <i class="fas fa-list-alt"></i> Options
                </button>
                <button type="button" (click)="queryOptions()" class="btn btn-warning">
                  <i class="fas fa-filter"></i> Query Options
                </button>
              </div>
            </div>
          </div>

          <!-- Query Builder -->
          <div class="row mb-3">
            <div class="col-12">
              <div class="card" style="background: #f8f9fa; border: 2px dashed #667eea;">
                <div class="card-body">
                  <label style="font-weight: 600; color: #667eea;">
                    <i class="fas fa-code"></i> Advanced Query Builder
                  </label>
                  <textarea 
                    class="form-control mt-2" 
                    type="text" 
                    rows="2" 
                    [(ngModel)]="query"
                    placeholder="Query Search..."
                    style="font-family: monospace; border-radius: 8px;"></textarea>
                  <small class="text-muted mt-2 d-block">
                    <i class="fas fa-info-circle"></i> 
                    <strong>Available keys:</strong> low, close, sma20, sma50, godFather, volume, RSI, MACD, HIGH52, VWAP, sector, MACDSignal, EMA5|5, EMA10|5, EMA14|1H, EMA21|1H, EMA50|1H, exchange
                  </small>
                  <button type="button" (click)="querySearch()" class="btn btn-sm btn-danger mt-2">
                    <i class="fas fa-play"></i> Execute Query
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Loading State -->
          <div *ngIf="rowStockData.length < 1" class="text-center py-5">
            <div class="spinner-grow text-success" role="status" style="width: 3rem; height: 3rem;"></div>
            <p class="mt-3 text-muted">Loading momentum stocks...</p>
          </div>

          <!-- Data Grid -->
          <div *ngIf="rowStockData.length > 0">
            <ag-grid-angular 
              class="ag-theme-quartz" 
              style="height: 500px;width: 100%" 
              [rowData]="rowStockData"
              [suppressExcelExport]="true" 
              [rowSelection]="rowSelection" 
              [gridOptions]="gridStockOptions" 
              [pagination]="true"
              [defaultColDef]="defaultColDef" 
              [paginationPageSize]="paginationPageSize"
              [domLayout]="'normal'"
              [columnDefs]="colStocksDefs"
              (gridReady)="onGridStockReady($event)">
            </ag-grid-angular>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Volume Shockers Section -->
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header text-white" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">
          <div class="d-flex justify-content-between align-items-center">
            <h5 class="mb-0">
              <i class="fas fa-fire"></i> Volume Shockers
              <span class="badge badge-warning ml-2">ðŸ”¥ High Activity</span>
            </h5>
            <span class="badge badge-light">{{rowData.length}} stocks</span>
          </div>
        </div>
        <div class="card-body">
          <!-- Search and Export Controls -->
          <div class="row mb-3">
            <div class="col-md-6">
              <div class="input-group">
                <input 
                  class="form-control" 
                  type="text" 
                  [(ngModel)]="searchQuery"
                  (input)="onSearchInputChange()" 
                  placeholder="ðŸ” Search volume shockers..."
                  style="border-radius: 10px 0 0 10px;">
                <div class="input-group-append">
                  <span class="input-group-text" style="background: #ef4444; color: white; border-radius: 0 10px 10px 0;">
                    <i class="fas fa-search"></i>
                  </span>
                </div>
              </div>
            </div>
            <div class="col-md-6 text-right">
              <button class="btn btn-success" (click)="onBtnExport()">
                <i class="fas fa-file-excel"></i> Download CSV
              </button>
            </div>
          </div>

          <!-- Loading State -->
          <div *ngIf="rowData.length < 1" class="text-center py-5">
            <div class="spinner-grow text-danger" role="status" style="width: 3rem; height: 3rem;"></div>
            <p class="mt-3 text-muted">Loading volume shockers...</p>
          </div>

          <!-- Data Grid -->
          <div *ngIf="rowData.length > 0">
            <ag-grid-angular 
              class="ag-theme-quartz" 
              style="height: 500px;width: 100%" 
              [rowData]="rowData"
              [suppressExcelExport]="true" 
              [rowSelection]="rowSelection" 
              [gridOptions]="gridOptions" 
              [pagination]="true"
              [defaultColDef]="defaultColDef" 
              [paginationPageSize]="paginationPageSize"
              [domLayout]="'normal'"
              [columnDefs]="colDefs"
              (gridReady)="onGridReady($event)">
            </ag-grid-angular>
          </div>
        </div>
      </div>
    </div>
  </div>

  </div>
  <!-- End isLoading wrapper -->

</div>

  
  
  <span>
    if (record['close'] > 50 && res['d'][32] > 30000 && res['d'][33] > 1.2 && res['d'][34] > 2000000000 && res['d'][34] < 2000000000000)  
    <br>
    // 32 "average_volume_90d_calc", // > 500k if less stocks there means > 300k
    <br>
    // 33 "relative_volume_10d_calc", // > 1.2 or 1.5
    <br>
    // "34 market_cap_basic" // > 2B to 2000B (1 Billon = 100cr)
    <br>
    position serach res['EMA14|1H'] > res['EMA21|1H'] && res['EMA21|1H'] > res['EMA50|1H'] && res['volume'] >= 200000
    <br>
    res['low'] <= res['godFather'] && res['close'] >= res['godFather'] && res['volume'] >= 200000
    <br>
    select pivot weekly monthy,yearly ranges and trade traditional pivot logic
  </span>
